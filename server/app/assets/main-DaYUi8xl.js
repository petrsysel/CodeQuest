var C=Object.defineProperty;var k=(d,t,s)=>t in d?C(d,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):d[t]=s;var n=(d,t,s)=>(k(d,typeof t!="symbol"?t+"":t,s),s);import{P as b,C as N,N as P,S as K}from"./NotificationUI-CzwHS9Nb.js";import{d as r}from"./easybox-DL96ur1g.js";import{h as e}from"./hyperscript-CXB_bmuN.js";import"./blockly-O3kjd3d3.js";import"./uuid-D8aEg3BZ.js";import"./browser-split-_YnTQ0tN.js";import"./class-list-B-BPAtmO.js";import"./indexof-BYpMsQjK.js";const D=e("div.platform-navbar-container",e("a",e("div.platform-title","CodeBlockie"),{href:"."}),e("div.platform-bar#platform-user-bar",e("p#platform-user-name","User Name"),e("button#platform-log-out-btn.platform-btn","Odhlásit se")),e("div.platform-bar#platform-guest-bar",e("button#platform-log-in-btn.platform-btn","Přihlásit se"),e("button#platform-register-btn.platform-btn","Registrovat se")));class j{constructor(t){n(this,"navbarElement");n(this,"signal");n(this,"userBar");n(this,"guestBar");n(this,"usernameLabel");n(this,"loginButton");n(this,"logoutButton");n(this,"registerButton");this.signal=new r.Signal,this.navbarElement=r.DomHelper.get(t),this.navbarElement.appendChild(D),this.userBar=r.DomHelper.get("platform-user-bar"),this.guestBar=r.DomHelper.get("platform-guest-bar"),this.usernameLabel=r.DomHelper.get("platform-user-name"),this.loginButton=r.DomHelper.get("platform-log-in-btn"),this.logoutButton=r.DomHelper.get("platform-log-out-btn"),this.registerButton=r.DomHelper.get("platform-register-btn"),this.loginButton.addEventListener("click",()=>{this.signal.emit("log-in-request",null)}),this.logoutButton.addEventListener("click",()=>{this.signal.emit("log-out-request",null)}),this.registerButton.addEventListener("click",()=>{this.signal.emit("register-request",null)})}on(t,s){this.signal.on(t,s)}render(t){t.user?this.showUserBar(t.user):this.showGuestBar()}showUserBar(t){this.userBar.style.display="flex",this.guestBar.style.display="none",this.usernameLabel.innerHTML=t.fullname}showGuestBar(){this.userBar.style.display="none",this.guestBar.style.display="flex"}}const I=()=>e("div.dialogue-overlay",e("div.dialogue-window",e("div.dialogue-header",e("p.window-label","Label"),e("a.dialogue-close-btn",{href:"javascript:void(0)"},e("img",{src:"./images/icons/cq-close.png"}))),e("div.error-baner","error message"),e("div.dialogue-body"),e("div.dialogue-footer",e("button.platform-btn.dialogue-ok-btn","OK"))));class B{constructor(){n(this,"windowElement");n(this,"bodyElement");n(this,"okBtnElement");n(this,"closeBtnElement");n(this,"labelElement");n(this,"errorElement");this.windowElement=r.DomHelper.makeDiv(),this.windowElement.appendChild(I()),r.DomHelper.appentToBody(this.windowElement),this.bodyElement=this.windowElement.getElementsByClassName("dialogue-body").item(0),this.okBtnElement=this.windowElement.getElementsByClassName("dialogue-ok-btn").item(0),this.closeBtnElement=this.windowElement.getElementsByClassName("dialogue-close-btn").item(0),this.labelElement=this.windowElement.getElementsByClassName("window-label").item(0),this.errorElement=this.windowElement.getElementsByClassName("error-baner").item(0),this.hideError(),this.hide()}show(t,s){return this.showUp(),new Promise((o,i)=>{i("Not implemented yet...")})}showUp(){this.windowElement.style.display="block"}hide(){this.windowElement.style.display="none"}showError(t){this.errorElement.style.display="block",this.errorElement.innerHTML=t}hideError(){this.errorElement.style.display="none",this.errorElement.innerHTML=""}validate(t){throw new Error("Unimplemented data validation.")}}const J=e("div",e("table",e("tr",e("td",e("label",{for:"platform-login-username"},"Uživatelské jméno")),e("td",e("input#platform-login-username"))),e("tr",e("td",e("label",{for:"platform-login-password"},"Heslo")),e("td",e("input#platform-login-password",{type:"password"})))));class T extends B{constructor(){super();n(this,"usernameElement");n(this,"passwordElement");this.bodyElement.appendChild(J),this.labelElement.innerHTML="Přihlášení",this.okBtnElement.innerHTML="Přihlásit se",this.usernameElement=r.DomHelper.get("platform-login-username"),this.passwordElement=r.DomHelper.get("platform-login-password")}show(s,o){return this.hideError(),s&&this.showError(s),this.showUp(),this.usernameElement.value="",this.passwordElement.value="",new Promise((i,h)=>{this.closeBtnElement.onclick=()=>{this.hide(),i(void 0)},this.okBtnElement.onclick=()=>{i({username:this.usernameElement.value,password:this.passwordElement.value}),this.hide()}})}}const L=e("div",e("p","    Údaje označené * jsou povinné"),e("table",e("tr",e("td",e("label",{for:"platform-register-username"},"Uživatelské jméno*")),e("td",e("input#platform-register-username"))),e("tr",e("td",e("label",{for:"platform-register-fullname"},"Celé jméno")),e("td",e("input#platform-register-fullname"))),e("tr",e("td",e("label",{for:"platform-register-email"},"Email*")),e("td",e("input#platform-register-email"))),e("tr",e("td",e("label",{for:"platform-register-password"},"Heslo*")),e("td",e("input#platform-register-password",{type:"password"}))),e("tr",e("td",e("label",{for:"platform-register-password-again"},"Heslo znovu*")),e("td",e("input#platform-register-password-again",{type:"password"})))));class A extends B{constructor(){super();n(this,"usernameElement");n(this,"fullnameElement");n(this,"emailElement");n(this,"passwordElement");n(this,"passwordAgainElement");this.bodyElement.appendChild(L),this.labelElement.innerHTML="Registrace",this.okBtnElement.innerHTML="Registrovat se",this.usernameElement=r.DomHelper.get("platform-register-username"),this.fullnameElement=r.DomHelper.get("platform-register-fullname"),this.emailElement=r.DomHelper.get("platform-register-email"),this.passwordElement=r.DomHelper.get("platform-register-password"),this.passwordAgainElement=r.DomHelper.get("platform-register-password-again")}show(s,o){return this.showUp(),this.hideError(),s&&this.showError(s),o?(this.usernameElement.value=o.username,this.fullnameElement.value=o.fullname,this.emailElement.value=o.email,this.passwordElement.value=o.password,this.passwordAgainElement.value=o.passwordAgain):(this.usernameElement.value="",this.fullnameElement.value="",this.emailElement.value="",this.passwordElement.value="",this.passwordAgainElement.value=""),new Promise((i,h)=>{this.closeBtnElement.onclick=()=>{this.hide(),i(void 0)},this.okBtnElement.onclick=()=>{i({username:this.usernameElement.value,fullname:this.fullnameElement.value,email:this.emailElement.value,password:this.passwordElement.value,passwordAgain:this.passwordAgainElement.value}),this.hide()}})}validate(s){function o(h){return h.split("").filter(c=>!i(c)).some(c=>c==c.toUpperCase())}function i(h){return/[0-9]/.test(h)}return!s.email||!s.username||!s.password||!s.passwordAgain?{isValid:!1,error:"Nejsou vyplněna všechna povinná pole"}:s.username.length<4?{isValid:!1,error:"Uživatelské jméno musí obsahovat alespoň 4 znaky"}:s.email.split("@").length!=2?{isValid:!1,error:"Neplatný email"}:s.password.length<8?{isValid:!1,error:"Heslo musí obsahovat alespoň 8 znaků"}:o(s.password)?i(s.password)?s.password!==s.passwordAgain?{isValid:!1,error:"Hesla se musí shodovat"}:{isValid:!0}:{isValid:!1,error:"Heslo musí obsahovat alespoň jedno číslo"}:{isValid:!1,error:"Heslo musí obsahovat alespoň jedno velké písmeno"}}}function v(){return" data:image/png;base64,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"}class R{constructor(t,s,o,i,h,c,w,E,y){n(this,"loggedUser");const m=E.get(),f=l=>{window.open(`editor.html?puzzleid=${l}`)},z=l=>{window.open(`game.html?puzzleid=${l}`)};let g=0;o.render({loggedUser:!1}),s.render({loggedUser:!1,renderMode:"public"}),t.isLogged(m).then(l=>{this.loggedUser=l;const a=l!=null;o.render({loggedUser:a,user:l}),s.render({loggedUser:a,renderMode:"public"}),i.render([],{mode:"public",loggedUser:this.loggedUser!=null,append:!1,limit:10}),t.fetchPuzzles(m,"public",10,0).then(u=>{i.render(u,{mode:"public",loggedUser:this.loggedUser!=null,append:!1,limit:10}),g=10})}),o.on("log-in-request",async()=>{async function l(a){const u=await h.show(a);if(!u)return;const p=await t.loginRequest(m,u.username,u.password);p.error?l(p.error):location.reload()}l()}),o.on("log-out-request",async()=>{await t.logOut(m),location.reload()}),o.on("register-request",async()=>{async function l(a,u){const p=await c.show(a,u);if(!p)return;const H=c.validate(p);if(!H.isValid)l(H.error,p);else{const U=await t.registerRequest(m,{email:p.email,fullname:p.fullname,username:p.username,id:"---"},p.password);U.error?l(U.error):(await t.loginRequest(m,p.username,p.password),location.reload())}}l()}),s.on("insert-code-request",async()=>{const l=await w.show();if(!l)return;const a=await t.findByCode(l);if(a)z(a.id);else{await y.notify("Úloha s tímto kódem neexistuje");return}}),s.on("custom-puzzles-request",()=>{s.render({loggedUser:this.loggedUser!=null,renderMode:"custom"}),t.fetchPuzzles(m,"private",10,0).then(l=>{i.render(l,{mode:"custom",loggedUser:this.loggedUser!=null,append:!1,limit:10}),g=10})}),s.on("public-puzzles-request",()=>{s.render({loggedUser:this.loggedUser!=null,renderMode:"public"}),t.fetchPuzzles(m,"public",10,0).then(l=>{i.render(l,{mode:"public",loggedUser:this.loggedUser!=null,append:!1,limit:10}),g=10})}),i.on("load-more",l=>{const a=l.mode==="custom"?"private":"public";t.fetchPuzzles(m,a,10,g).then(u=>{i.render(u,{mode:l.mode,loggedUser:this.loggedUser!=null,append:!0,limit:10}),g+=10})}),i.on("create-puzzle-request",()=>{const l=new b;this.loggedUser&&t.savePuzzle(m,l,this.loggedUser,v(),null).then(a=>{a.success?window.open(`editor.html?puzzleid=${l.getId()}`):console.error(a.error)})}),i.on("edit-request",l=>{f(l.puzzleId)}),i.on("play-puzzle",l=>{z(l.puzzleId)}),i.on("duplicate-puzzle",async l=>{const a=new b,u=await t.getContent(m,l.puzzleId);if(u.error)console.error(u.error);else{a.loadFromString(u.response);const p=a.duplicate();await t.savePuzzle(m,p,this.loggedUser,v(),null),window.location.reload()}}),i.on("publish-request",async l=>{new b,await t.publish(m,l.puzzleId,!0),window.location.reload()}),i.on("unpublish-request",async l=>{new b,await t.publish(m,l.puzzleId,!1),window.location.reload()}),i.on("remove-puzzle",async l=>{await y.dialogue("Opravdu chceš odstranit úlohu?")==="yes"&&(await t.remove(m,l.puzzleId),window.location.reload())}),i.on("search-request",async l=>{const a=l.mode==="custom"?m:"-",u=await t.findPuzzles(a,l.query);i.render(u,{mode:l.mode,loggedUser:this.loggedUser!=null,limit:10,append:!1})})}}const F=e("div.platform-sidebar-container",e("div.platform-sidebar-btn#platform-sidebar-insert-code","Vložit kód úlohy"),e("div.platform-sidebar-btn#platform-sidebar-public-puzzles","Veřejné úlohy"),e("div.platform-sidebar-btn#platform-sidebar-custom-puzzles","Vlastní úlohy"));class q{constructor(t){n(this,"signal");n(this,"sidebarElement");n(this,"insertCodeElement");n(this,"publicPuzzlesElement");n(this,"customPuzzlesElement");this.signal=new r.Signal,this.sidebarElement=r.DomHelper.get(t),this.sidebarElement.appendChild(F),this.insertCodeElement=r.DomHelper.get("platform-sidebar-insert-code"),this.publicPuzzlesElement=r.DomHelper.get("platform-sidebar-public-puzzles"),this.customPuzzlesElement=r.DomHelper.get("platform-sidebar-custom-puzzles"),this.insertCodeElement.addEventListener("click",()=>{this.signal.emit("insert-code-request",null)}),this.publicPuzzlesElement.addEventListener("click",()=>{this.signal.emit("public-puzzles-request",null)}),this.customPuzzlesElement.addEventListener("click",()=>{this.signal.emit("custom-puzzles-request",null)})}on(t,s){this.signal.on(t,s)}render(t){t.loggedUser?this.renderUser():this.renderGuest(),t.renderMode==="custom"?this.selectedCustom():this.selectedPublic()}renderGuest(){this.customPuzzlesElement.style.display="none"}renderUser(){this.customPuzzlesElement.style.display="block"}selectedPublic(){this.publicPuzzlesElement.classList.add("platform-sidebar-selected-page"),this.customPuzzlesElement.classList.remove("platform-sidebar-selected-page")}selectedCustom(){this.publicPuzzlesElement.classList.remove("platform-sidebar-selected-page"),this.customPuzzlesElement.classList.add("platform-sidebar-selected-page")}}const S=e("div",e("table",e("tr",e("td",e("label",{for:"platform-insert-code"},"Kód úlohy")),e("td",e("input#platform-insert-code")))));class W extends B{constructor(){super();n(this,"codeInputElement");this.bodyElement.appendChild(S),this.labelElement.innerHTML="Vložit kód úlohy",this.okBtnElement.innerHTML="Zobrazit úlohu",this.codeInputElement=r.DomHelper.get("platform-insert-code")}show(s,o){return this.showUp(),s?this.showError(s):this.hideError(),o?this.codeInputElement.value=o:this.codeInputElement.value="",new Promise((i,h)=>{this.closeBtnElement.onclick=()=>{this.hide(),i(void 0)},this.okBtnElement.onclick=()=>{i(this.codeInputElement.value),this.hide()}})}}const X=e("div.puzzle-list-container",e("div.puzzle-list-header",e("div.puzzle-list-search-bar",e("input.puzzle-list-search",{placeholder:"Zadejte název úlohy"}),e("button.puzzle-list-search-btn.platform-btn.dark-btn","Vyhledat")),e("div.align-right",e("button.puzzle-list-create-btn.platform-btn.dark-btn","Vytvořit novou úlohu"))),e("div.puzzle-list-body-container",e("div.puzzle-list-empty-label","Zatím zde nejsou žádné úlohy"),e("div.puzzle-list-list-container",e("div.puzzle-list-item",e("div.puzzle-list-preview-img",e("img",{src:v()})),e("div.puzzle-list-item-body",e("div.puzzle-list-item-info",e("p.puzzle-list-item-name","Strašně dlouhatánský název úlohy"),e("p.puzzle-list-item-author","Autor"),e("p.puzzle-list-item-code","Kód")),e("div.puzzle-list-item-action-bar",e("a.puzzle-list-item-edit.tooltip",{href:"javascript:void(0)"},e("span.tooltiptext","Editovat úlohu"),e("img",{src:"./images/icons/cq-edit.png"})),e("a.puzzle-list-item-play.tooltip",{href:"javascript:void(0)"},e("span.tooltiptext","Spustit úlohu"),e("img",{src:"./images/icons/cq-play.png"})),e("a.puzzle-list-item-duplicate.tooltip",{href:"javascript:void(0)"},e("span.tooltiptext","Vytvořit kopii"),e("img",{src:"./images/icons/cq-duplicate.png"})),e("a.puzzle-list-item-publish.tooltip",{href:"javascript:void(0)"},e("span.tooltiptext","Sdílet jako veřejnou úlohu"),e("img",{src:"./images/icons/cq-publish.png"})),e("a.puzzle-list-item-unpublish.tooltip",{href:"javascript:void(0)"},e("span.tooltiptext","Zrušit sdílení úlohy"),e("img",{src:"./images/icons/cq-unpublish.png"})),e("a.puzzle-list-item-delete.tooltip",{href:"javascript:void(0)"},e("span.tooltiptext","Smazat úlohu"),e("img",{src:"./images/icons/cq-delete.png"})))))),e("div.align-center",e("button.puzzle-list-load-more-btn.platform-btn.dark-btn","Načíst další"))));class x{constructor(t){n(this,"signal");n(this,"listElement");n(this,"createNewButton");n(this,"theresNothing");n(this,"itemTemplate");n(this,"loadMoreButton");n(this,"puzzleListContainer");n(this,"searchButton");n(this,"searchBar");this.signal=new r.Signal,this.listElement=r.DomHelper.get(t),this.listElement.appendChild(X),this.createNewButton=this.listElement.getElementsByClassName("puzzle-list-create-btn")[0],this.theresNothing=this.listElement.getElementsByClassName("puzzle-list-empty-label")[0],this.itemTemplate=this.listElement.getElementsByClassName("puzzle-list-item")[0],this.puzzleListContainer=this.listElement.getElementsByClassName("puzzle-list-list-container")[0],this.loadMoreButton=this.listElement.getElementsByClassName("puzzle-list-load-more-btn")[0],this.searchBar=this.listElement.getElementsByClassName("puzzle-list-search")[0],this.searchButton=this.listElement.getElementsByClassName("puzzle-list-search-btn")[0],this.itemTemplate.style.display="none",this.createNewButton.addEventListener("click",()=>{this.signal.emit("create-puzzle-request",{})})}on(t,s){this.signal.on(t,s)}render(t,s){this.loadMoreButton.onclick=()=>{this.signal.emit("load-more",{mode:s.mode})},this.searchButton.onclick=()=>{this.signal.emit("search-request",{mode:s.mode,query:this.searchBar.value})},s.mode==="public"?this.createNewButton.style.display="none":this.createNewButton.style.display="block",t.length==0?(this.theresNothing.style.display="block",this.loadMoreButton.style.display="none"):(this.theresNothing.style.display="none",this.loadMoreButton.style.display="block"),s.limit>t.length&&(this.loadMoreButton.style.display="none"),s.append||(this.puzzleListContainer.innerHTML=""),t.forEach(o=>{const i=this.itemTemplate.cloneNode(!0);i.style.display="flex";const h=i.getElementsByClassName("puzzle-list-item-name")[0];h.innerHTML=o.name;const c=i.getElementsByClassName("puzzle-list-item-author")[0];c.innerHTML=`Autor: ${o.author}`;const w=i.getElementsByClassName("puzzle-list-item-code")[0];w.innerHTML=o.code?`Kód: ${o.code}`:"";const E=i.getElementsByClassName("puzzle-list-item-edit")[0];E.addEventListener("click",()=>{this.signal.emit("edit-request",{puzzleId:o.id})}),i.getElementsByClassName("puzzle-list-item-play")[0].addEventListener("click",()=>{this.signal.emit("play-puzzle",{puzzleId:o.id})});const m=i.getElementsByClassName("puzzle-list-item-duplicate")[0];m.addEventListener("click",()=>{this.signal.emit("duplicate-puzzle",{puzzleId:o.id})});const f=i.getElementsByClassName("puzzle-list-item-publish")[0];f.addEventListener("click",()=>{this.signal.emit("publish-request",{puzzleId:o.id})});const z=i.getElementsByClassName("puzzle-list-item-unpublish")[0];z.addEventListener("click",()=>{this.signal.emit("unpublish-request",{puzzleId:o.id})});const g=i.getElementsByClassName("puzzle-list-item-delete")[0];g.addEventListener("click",()=>{this.signal.emit("remove-puzzle",{puzzleId:o.id})});const l=i.getElementsByClassName("puzzle-list-preview-img")[0].getElementsByTagName("img")[0];l.src=o.img,o.code?(z.style.display="block",f.style.display="none"):(f.style.display="block",z.style.display="none"),s.mode==="public"&&(g.style.display="none",E.style.display="none",f.style.display="none",z.style.display="none",s.loggedUser||(m.style.display="none")),this.puzzleListContainer.appendChild(i)})}}function O(){const d=new K,t=new q("platform-sidebar"),s=new j("platform-navbar"),o=new x("platform-puzzle-list"),i=new T,h=new A,c=new W,w=new N,E=new P;new R(d,t,s,o,i,h,c,w,E)}window.onload=O;
